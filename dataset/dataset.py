import openpyxl
from openpyxl.worksheet.table import Table, TableStyleInfo

## Criando uma tabela Excel para usar como DataSet

wb = openpyxl.Workbook()
ws = wb.active

data = [
    ["data", "vendas"],
    ["2020-01-01", "40"],
    ["2020-01-02", "10"],
    ["2020-01-03", "30"],
    ["2020-01-04", "25"],
    ["2020-01-05", "45"],
    ["2020-01-06", "20"],
    ["2020-01-07", "35"],
    ["2020-01-08", "50"],
    ["2020-01-09", "15"],
    ["2020-01-10", "40"],
    ["2020-01-11", "30"],
    ["2020-01-12", "25"],
    ["2020-01-13", "20"],
    ["2020-01-14", "10"],
    ["2020-01-15", "50"],
    ["2020-01-16", "45"],
    ["2020-01-17", "30"],
    ["2020-01-18", "35"],
    ["2020-01-19", "25"],
    ["2020-01-20", "20"],
    ["2020-01-21", "15"],
    ["2020-01-22", "40"],
    ["2020-01-23", "45"],
    ["2020-01-24", "35"],
    ["2020-01-25", "30"],
    ["2020-01-26", "10"],
    ["2020-01-27", "20"],
    ["2020-01-28", "25"],
    ["2020-01-29", "50"],
    ["2020-01-30", "40"],
    ["2020-01-31", "30"],
    ["2020-02-01", "20"],
    ["2020-02-02", "25"],
    ["2020-02-03", "40"],
    ["2020-02-04", "30"],
    ["2020-02-05", "15"],
    ["2020-02-06", "50"],
    ["2020-02-07", "35"],
    ["2020-02-08", "20"],
    ["2020-02-09", "10"],
    ["2020-02-10", "45"],
    ["2020-02-11", "40"],
    ["2020-02-12", "25"],
    ["2020-02-13", "35"],
    ["2020-02-14", "30"],
    ["2020-02-15", "15"],
    ["2020-02-16", "20"],
    ["2020-02-17", "50"],
    ["2020-02-18", "45"],
    ["2020-02-19", "25"],
    ["2020-02-20", "30"],
    ["2020-02-21", "10"],
    ["2020-02-22", "20"],
    ["2020-02-23", "35"],
    ["2020-02-24", "40"],
    ["2020-02-25", "25"],
    ["2020-02-26", "30"],
    ["2020-02-27", "15"],
    ["2020-02-28", "50"],
    ["2020-02-29", "35"],
    ["2020-03-01", "20"],
    ["2020-03-02", "10"],
    ["2020-03-03", "45"],
    ["2020-03-04", "40"],
    ["2020-03-05", "25"],
    ["2020-03-06", "30"],
    ["2020-03-07", "35"],
    ["2020-03-08", "20"],
    ["2020-03-09", "15"],
    ["2020-03-10", "50"],
    ["2020-03-11", "40"],
    ["2020-03-12", "30"],
    ["2020-03-13", "25"],
    ["2020-03-14", "10"],
    ["2020-03-15", "45"],
    ["2020-03-16", "20"],
    ["2020-03-17", "35"],
    ["2020-03-18", "50"],
    ["2020-03-19", "15"],
    ["2020-03-20", "40"],
    ["2020-03-21", "30"],
    ["2020-03-22", "25"],
    ["2020-03-23", "20"],
    ["2020-03-24", "10"],
    ["2020-03-25", "50"],
    ["2020-03-26", "45"],
    ["2020-03-27", "30"],
    ["2020-03-28", "35"],
    ["2020-03-29", "25"],
    ["2020-03-30", "20"],
    ["2020-03-31", "15"],
    ["2020-04-01", "40"],
    ["2020-04-02", "45"],
    ["2020-04-03", "35"],
    ["2020-04-04", "30"],
    ["2020-04-05", "10"],
    ["2020-04-06", "20"],
    ["2020-04-07", "25"],
    ["2020-04-08", "50"],
    ["2020-04-09", "40"],
    ["2020-04-10", "30"],
    ["2020-04-11", "20"],
    ["2020-04-12", "15"],
    ["2020-04-13", "50"],
    ["2020-04-14", "35"],
    ["2020-04-15", "25"],
    ["2020-04-16", "30"],
    ["2020-04-17", "20"],
    ["2020-04-18", "10"],
    ["2020-04-19", "40"],
    ["2020-04-20", "45"],
    ["2020-04-21", "25"],
    ["2020-04-22", "35"],
    ["2020-04-23", "30"],
    ["2020-04-24", "15"],
    ["2020-04-25", "50"],
    ["2020-04-26", "20"],
    ["2020-04-27", "25"],
    ["2020-04-28", "40"],
    ["2020-04-29", "30"],
    ["2020-04-30", "10"],
    ["2020-05-01", "45"],
    ["2020-05-02", "40"],
    ["2020-05-03", "25"],
    ["2020-05-04", "35"],
    ["2020-05-05", "20"],
    ["2020-05-06", "10"],
    ["2020-05-07", "50"],
    ["2020-05-08", "40"],
    ["2020-05-09", "30"],
    ["2020-05-10", "25"],
    ["2020-05-11", "15"],
    ["2020-05-12", "20"],
    ["2020-05-13", "35"],
    ["2020-05-14", "50"],
    ["2020-05-15", "40"],
    ["2020-05-16", "10"],
    ["2020-05-17", "45"],
    ["2020-05-18", "20"],
    ["2020-05-19", "25"],
    ["2020-05-20", "30"],
    ["2020-05-21", "15"],
    ["2020-05-22", "40"],
    ["2020-05-23", "50"],
    ["2020-05-24", "35"],
    ["2020-05-25", "20"],
    ["2020-05-26", "10"],
    ["2020-05-27", "45"],
    ["2020-05-28", "25"],
    ["2020-05-29", "40"],
    ["2020-05-30", "30"],
    ["2020-05-31", "35"],
    ["2020-06-01", "20"],
    ["2020-06-02", "15"],
    ["2020-06-03", "50"],
    ["2020-06-04", "45"],
    ["2020-06-05", "25"],
    ["2020-06-06", "30"],
    ["2020-06-07", "20"],
    ["2020-06-08", "10"],
    ["2020-06-09", "40"],
    ["2020-06-10", "35"],
    ["2020-06-11", "30"],
    ["2020-06-12", "25"],
    ["2020-06-13", "50"],
    ["2020-06-14", "15"],
    ["2020-06-15", "20"],
    ["2020-06-16", "40"],
    ["2020-06-17", "35"],
    ["2020-06-18", "10"],
    ["2020-06-19", "45"],
    ["2020-06-20", "30"],
    ["2020-06-21", "25"],
    ["2020-06-22", "50"],
    ["2020-06-23", "20"],
    ["2020-06-24", "15"],
    ["2020-06-25", "35"],
    ["2020-06-26", "40"],
    ["2020-06-27", "30"],
    ["2020-06-28", "25"],
    ["2020-06-29", "10"],
    ["2020-06-30", "45"],
    ["2020-07-01", "50"],
    ["2020-07-02", "20"],
    ["2020-07-03", "15"],
    ["2020-07-04", "35"],
    ["2020-07-05", "40"],
    ["2020-07-06", "30"],
    ["2020-07-07", "25"],
    ["2020-07-08", "10"],
    ["2020-07-09", "50"],
    ["2020-07-10", "45"],
    ["2020-07-11", "20"],
    ["2020-07-12", "35"],
    ["2020-07-13", "40"],
    ["2020-07-14", "25"],
    ["2020-07-15", "30"],
    ["2020-07-16", "15"],
    ["2020-07-17", "50"],
    ["2020-07-18", "20"],
    ["2020-07-19", "35"],
    ["2020-07-20", "10"],
    ["2020-07-21", "45"],
    ["2020-07-22", "40"],
    ["2020-07-23", "25"],
    ["2020-07-24", "30"],
    ["2020-07-25", "50"],
    ["2020-07-26", "20"],
    ["2020-07-27", "10"],
    ["2020-07-28", "35"],
    ["2020-07-29", "40"],
    ["2020-07-30", "30"],
    ["2020-07-31", "25"],
    ["2020-08-01", "50"],
    ["2020-08-02", "15"],
    ["2020-08-03", "20"],
    ["2020-08-04", "10"],
    ["2020-08-05", "45"],
    ["2020-08-06", "40"],
    ["2020-08-07", "25"],
    ["2020-08-08", "35"],
    ["2020-08-09", "20"],
    ["2020-08-10", "50"],
    ["2020-08-11", "15"],
    ["2020-08-12", "40"],
    ["2020-08-13", "30"],
    ["2020-08-14", "25"],
    ["2020-08-15", "10"],
    ["2020-08-16", "50"],
    ["2020-08-17", "45"],
    ["2020-08-18", "20"],
    ["2020-08-19", "35"],
    ["2020-08-20", "40"],
    ["2020-08-21", "30"],
    ["2020-08-22", "25"],
    ["2020-08-23", "10"],
    ["2020-08-24", "50"],
    ["2020-08-25", "15"],
    ["2020-08-26", "20"],
    ["2020-08-27", "35"],
    ["2020-08-28", "40"],
    ["2020-08-29", "10"],
    ["2020-08-30", "25"],
    ["2020-08-31", "30"],
    ["2020-09-01", "50"],
    ["2020-09-02", "45"],
    ["2020-09-03", "20"],
    ["2020-09-04", "35"],
    ["2020-09-05", "40"],
    ["2020-09-06", "10"],
    ["2020-09-07", "25"],
    ["2020-09-08", "30"],
    ["2020-09-09", "15"],
    ["2020-09-10", "50"],
    ["2020-09-11", "45"],
    ["2020-09-12", "20"],
    ["2020-09-13", "35"],
    ["2020-09-14", "40"],
    ["2020-09-15", "25"],
    ["2020-09-16", "30"],
    ["2020-09-17", "10"],
    ["2020-09-18", "50"],
    ["2020-09-19", "20"],
    ["2020-09-20", "15"],
    ["2020-09-21", "35"],
    ["2020-09-22", "40"],
    ["2020-09-23", "25"],
    ["2020-09-24", "30"],
    ["2020-09-25", "50"],
    ["2020-09-26", "10"],
    ["2020-09-27", "20"],
    ["2020-09-28", "45"],
    ["2020-09-29", "40"],
    ["2020-09-30", "25"],
    ["2020-10-01", "30"],
    ["2020-10-02", "35"],
    ["2020-10-03", "10"],
    ["2020-10-04", "50"],
    ["2020-10-05", "15"],
    ["2020-10-06", "20"],
    ["2020-10-07", "45"],
    ["2020-10-08", "40"],
    ["2020-10-09", "25"],
    ["2020-10-10", "30"],
    ["2020-10-11", "35"],
    ["2020-10-12", "20"],
    ["2020-10-13", "50"],
    ["2020-10-14", "10"],
    ["2020-10-15", "45"],
    ["2020-10-16", "40"],
    ["2020-10-17", "25"],
    ["2020-10-18", "30"],
    ["2020-10-19", "15"],
    ["2020-10-20", "50"],
    ["2020-10-21", "35"],
    ["2020-10-22", "20"],
    ["2020-10-23", "45"],
    ["2020-10-24", "10"],
    ["2020-10-25", "40"],
    ["2020-10-26", "30"],
    ["2020-10-27", "25"],
    ["2020-10-28", "50"],
    ["2020-10-29", "20"],
    ["2020-10-30", "15"],
    ["2020-10-31", "40"],
    ["2020-11-01", "35"],
    ["2020-11-02", "10"],
    ["2020-11-03", "45"],
    ["2020-11-04", "50"],
    ["2020-11-05", "20"],
    ["2020-11-06", "15"],
    ["2020-11-07", "40"],
    ["2020-11-08", "30"],
    ["2020-11-09", "25"],
    ["2020-11-10", "10"],
    ["2020-11-11", "50"],
    ["2020-11-12", "35"],
    ["2020-11-13", "20"],
    ["2020-11-14", "40"],
    ["2020-11-15", "30"],
    ["2020-11-16", "10"],
    ["2020-11-17", "45"],
    ["2020-11-18", "50"],
    ["2020-11-19", "20"],
    ["2020-11-20", "15"],
    ["2020-11-21", "35"],
    ["2020-11-22", "40"],
    ["2020-11-23", "25"],
    ["2020-11-24", "30"],
    ["2020-11-25", "10"],
    ["2020-11-26", "50"],
    ["2020-11-27", "45"],
    ["2020-11-28", "20"],
    ["2020-11-29", "35"],
    ["2020-11-30", "40"],
    ["2020-12-01", "10"],
    ["2020-12-02", "25"],
    ["2020-12-03", "30"],
    ["2020-12-04", "50"],
    ["2020-12-05", "45"],
    ["2020-12-06", "20"],
    ["2020-12-07", "15"],
    ["2020-12-08", "35"],
    ["2020-12-09", "40"],
    ["2020-12-10", "10"],
    ["2020-12-11", "30"],
    ["2020-12-12", "25"],
    ["2020-12-13", "50"],
    ["2020-12-14", "45"],
    ["2020-12-15", "20"],
    ["2020-12-16", "35"],
    ["2020-12-17", "40"],
    ["2020-12-18", "10"],
    ["2020-12-19", "25"],
    ["2020-12-20", "30"],
    ["2020-12-21", "50"],
    ["2020-12-22", "15"],
    ["2020-12-23", "20"],
    ["2020-12-24", "40"],
    ["2020-12-25", "35"],
    ["2020-12-26", "10"],
    ["2020-12-27", "50"],
    ["2020-12-28", "20"],
    ["2020-12-29", "45"],
    ["2020-12-30", "30"],
    ["2020-12-31", "25"]
]

multiplicador = 1.5

for i in range(1, len(data)):
    data_atual = data[i][0]
    valor_vendas = int(data[i][1])

    if "2020-06" <= data_atual <= "2020-08":
        novo_valor_vendas = int(valor_vendas * multiplicador)
        data[i][1] = str(novo_valor_vendas)

for linha in data:
    print(linha)

for row in data:
    ws.append(row)

num_rows = len(data)
tab = Table(displayName="Tabela1", ref=f"A1:B{num_rows}")

style = TableStyleInfo(
    name="TableStyleMedium9",
    showFirstColumn=False,
    showLastColumn=False,
    showRowStripes=True,
    showColumnStripes=True,
)
tab.tableStyleInfo = style

ws.add_table(tab)

wb.save("tabela_excel3.xlsx")

from collections import defaultdict

vendas_por_mes = defaultdict(int)

for data_item in data[1:]:
    data_venda = data_item[0]
    mes_venda = data_venda.split("-")[1]
    vendas = int(data_item[1])
    vendas_por_mes[mes_venda] += vendas

mes_mais_vendas = max(vendas_por_mes, key=vendas_por_mes.get)
total_vendas_mes_mais = vendas_por_mes[mes_mais_vendas]

print("O mês com mais vendas foi:", mes_mais_vendas)
print("Total de vendas nesse mês:", total_vendas_mes_mais)
